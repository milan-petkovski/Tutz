<!DOCTYPE html>
<html lang="sr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tutz | Kviz</title>
    <meta name="theme-color" content="#d4d2f7">
    <meta name="description" content="Igrajte kviz u 99 noci u sumi!">
    <meta name="keywords" content="Tutz, tutz, tutz website, tutz site, website tutz, tutz linktree, tutz shop, shop tutz, linktree tutz, 99 noci u sumi">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tutz.netlify.app">
    <meta property="og:title" content="Tutz | Kviz">
    <meta property="og:description" content="Igrajte Tutz-ov kviz u 99 noci u sumi!">
    <meta property="og:image" content="https://i.postimg.cc/Qxp2574g/logo.png">
    <link rel="icon" type="image/x-icon" href="images/favicon.ico">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css">
</head>
<body>

<header id="header">
  <a href="index.html" class="logo"><img src="images/logo.png" alt="Logo"></a>
  <a href="linktree.html" class="linktree"><i class="fa-solid fa-tree"></i></a>
</header>

<div class="container">
  <h1>游 99 No캖i U 맛mi - Kviz 游</h1>
  <div id="welcome-section">
            <h2>Da li ste spremni da pre쬴vite 99 no캖i?</h2>
            <p class="intro-text">
                Ovaj kviz ima 30 pitanja o pre쬴vljavanju, neprijateljima i tajnama igre 99 no캖i u 코umi.
                Va코i odgovori 캖e otkriti ko ste vi u divljini elitni lovac, oprezni izvi캠a캜 ili mo쬯a rtva kultista!
            </p>
            <button id="start-button" class="btn">Krenimo!</button>
        </div>
        
        <div id="quiz-section" class="hidden">
            <h2 id="question-number">Pitanje 1/30</h2>
            <p id="question-text">Tekst pitanja...</p>
            
            <div id="answers-container" class="answers-grid">
                </div>
            
            <p id="error-message" class="error-msg"></p>
        </div>

        <div id="result-section" class="hidden">
            <h2>Kviz Zavr코en!</h2>
            <div id="final-score"></div>
            <p class="result-description">Da biste videli koja je <b>va코a klasa</b>, unesite svoju e-mail adresu.</p>
            
            <div id="email-submission">
                <input type="email" id="email-input" placeholder="Unesite va코u E-mail adresu" required>
                <button id="submit-email-button" class="btn email-btn">Po코alji Rezultate</button>
                <p id="email-error" class="error-msg"></p>
                <p id="email-success" class="success-msg hidden"></p>
            </div>
            <button id="restart-button" class="btn hidden">Ponovi Kviz</button>
            <button id="restart-button-after-email" class="btn hidden">Ponovi Kviz</button>
        </div>
</div>

</body>
</html>

<script>
const QUIZ_LENGTH = 30;
const questions = [
    {
        question: "Koju klasu obi캜no bira코 na po캜etku 99 No캖i u 맛mi?",
        answers: [
            { text: "Lovac (Hunter)", score: 3 },
            { text: "Pre쬴veli (Camper)", score: 2 },
            { text: "Izvi캠a캜 (Scavenger)", score: 1 },
            { text: "Kultista (Cultist)", score: 0 }
        ]
    },
    {
        question: "Kada padne prva no캖, 코ta uradi코 kao prvo?",
        answers: [
            { text: "Skupljam drva i palim vatru", score: 3 },
            { text: "Pravim bolje oru쬵e ili alat", score: 2 },
            { text: "Oja캜avam skloni코te ili gradim zid", score: 1 },
            { text: "Tra쬴m saveznike i pravim tim", score: 0 }
        ]
    },
    {
        question: "Koji resurs smatra코 najva쬹ijim za pre쬴vljavanje?",
        answers: [
            { text: "Drvo", score: 3 },
            { text: "Hrana (meso)", score: 2 },
            { text: "콯eljezo (Iron)", score: 1 },
            { text: "Konopac", score: 0 }
        ]
    },
    {
        question: "맚a je najopasniji neprijatelj u ranoj fazi igre?",
        answers: [
            { text: "Medved", score: 3 },
            { text: "Vuk", score: 2 },
            { text: "Sova (The Owl)", score: 1 },
            { text: "Glad i 쬰캠", score: 0 }
        ]
    },
    {
        question: "Ako na drvetu na캠e코 nepoznate simbole, 코ta uradi코?",
        answers: [
            { text: "Ignori코em i nastavljam dalje", score: 1 },
            { text: "Prou캜avam ih, tra쬰캖i skriveno zna캜enje", score: 3 },
            { text: "Fotografisem i pitam ostale igra캜e", score: 2 },
            { text: "Palim vatru da ih uklonim", score: 0 }
        ]
    },
    {
        question: "Koje oru쬵e najradije koristi코?",
        answers: [
            { text: "Sekira", score: 2 },
            { text: "Ma캜", score: 3 },
            { text: "Luk i strela", score: 1 },
            { text: "Pi코tolj (Revolver)", score: 0 }
        ]
    },
    {
        question: "맚a najvi코e ceni코 kod saigra캜a?",
        answers: [
            { text: "Hrabar i borben", score: 3 },
            { text: "Pametan i oprezan", score: 2 },
            { text: "Ve코t u skupljanju resursa", score: 1 },
            { text: "Dobar humor i zabavu", score: 0 }
        ]
    },
    {
        question: "U kojim no캖ima obi캜no ima코 najvi코e problema?",
        answers: [
            { text: "No캖i 1-30", score: 1 },
            { text: "No캖i 31-60", score: 2 },
            { text: "No캖i 61-99", score: 3 },
            { text: "Nikada, prilagodim se", score: 0 }
        ]
    },
    {
        question: "맚a misli코 da je glavni cilj igre?",
        answers: [
            { text: "Pre쬴veti 99 no캖i", score: 1 },
            { text: "Prona캖i izlaz iz 코ume", score: 3 },
            { text: "Otkriti sve tajne 코ume", score: 2 },
            { text: "Postati vo캠a kultista", score: 0 }
        ]
    },
    {
        question: "Kada nai캠u kultisti, 코ta prvo radi코?",
        answers: [
            { text: "Be쬴m i sakrijem se", score: 1 },
            { text: "Napadam iz zasede", score: 3 },
            { text: "Postavljam zamke oko baze", score: 2 },
            { text: "Poku코avam pregovarati", score: 0 }
        ]
    },
    {
        question: "Omiljeno mesto za kampovanje?",
        answers: [
            { text: "Duboka 코uma no캖u", score: 2 },
            { text: "Blizu reke ili jezera", score: 1 },
            { text: "Na ulazu u pe캖inu (shelter)", score: 3 },
            { text: "Na otvorenom polju", score: 0 }
        ]
    },
    {
        question: "맚a uradi코 kad ti je inventar pun?",
        answers: [
            { text: "Bacim manje va쬹e stvari", score: 1 },
            { text: "Odmah vra캖am u bazu i praznim torbu", score: 2 },
            { text: "Izradim torbu (Backpack) za vi코e prostora", score: 3 },
            { text: "Nastavljam da sakupljam, ignorisano", score: 0 }
        ]
    },
    {
        question: "Kada 캜uje코 캜udne zvuke u mraku, 코ta radi코?",
        answers: [
            { text: "Palim baklju i idem da istra쬴m", score: 3 },
            { text: "Sakrijem se i 캜ekam da pro캠e", score: 2 },
            { text: "Zapaljujem vatru ja캜e i ostajem na mestu", score: 1 },
            { text: "Pevam da rasteram strah", score: 0 }
        ]
    },
    {
        question: "Kakav je tvoj plan protiv Sove (The Owl)?",
        answers: [
            { text: "Ga캠am je lukom sa bezbedne udaljenosti", score: 2 },
            { text: "Skrivam se i 캜ekam zoru", score: 1 },
            { text: "Napadam direktno ma캜em ili sekirom", score: 3 },
            { text: "Poku코avam da je smirim/prijatelji코em se", score: 0 }
        ]
    },
    {
        question: "Koja je najve캖a gre코ka koju vidi코 kod pre쬴vljavanja?",
        answers: [
            { text: "Izlazak napolje bez oru쬵a", score: 3 },
            { text: "Zaboraviti zalihu hrane i vode", score: 2 },
            { text: "Preveliki oslanjanje na druge", score: 1 },
            { text: "Lo코a izgradnja baze", score: 0 }
        ]
    },
    {
        question: "맚a bi najradije rtvovao za tim?",
        answers: [
            { text: "Sve resurse koje imam", score: 1 },
            { text: "Najbolje oru쬵e/alat", score: 2 },
            { text: "Vlastiti 쬴vot za spas drugih", score: 3 },
            { text: "Ni코ta, svako sam za sebe", score: 0 }
        ]
    },
    {
        question: "Koji je minimalni nivo Crafting Station koji ti treba?",
        answers: [
            { text: "Nivo 1 (Osnovni)", score: 1 },
            { text: "Nivo 2 (Srednji)", score: 2 },
            { text: "Nivo 3 (Napredni)", score: 3 },
            { text: "Ne koristim Crafting Station", score: 0 }
        ]
    },
    {
        question: "Koliko 캜esto prou캜ava코 pri캜u i tajne igre?",
        answers: [
            { text: "Nikad, samo se fokusiram na pre쬴vljavanje", score: 1 },
            { text: "Povremeno, kad imam vremena", score: 2 },
            { text: "Stalno, to je jako bitan deo igre", score: 3 },
            { text: "Samo gledam 코ta drugi ka쬿 na YouTube-u", score: 0 }
        ]
    },
    {
        question: "Koji jedan predmet bi ponio u 코umu?",
        answers: [
            { text: "Najbolji ma캜 koji imam", score: 3 },
            { text: "Kanister vode", score: 2 },
            { text: "Kompas", score: 1 },
            { text: "Pli코ana igra캜ka za sre캖u", score: 0 }
        ]
    },
    {
        question: "Kako se suprotstavlja코 napadu jelena (The Deer)?",
        answers: [
            { text: "Defanzivno, ostajem u bazi", score: 1 },
            { text: "Agresivno, pucam u glavu prvo", score: 3 },
            { text: "Ometam bakljom i be쬴m", score: 2 },
            { text: "Poku코avam da zaobi캠em i izbegnem", score: 0 }
        ]
    },
    {
        question: "Kako 캜esto menja코 lokaciju baze?",
        answers: [
            { text: "Samo kada me prisilno izbace", score: 1 },
            { text: "Posle svake velike bitke", score: 2 },
            { text: "Nikad, moja je baza savr코ena", score: 3 },
            { text: "Svaku no캖 (vole lutati)", score: 0 }
        ]
    },
    {
        question: "Kako gleda코 na trgovce u igri?",
        answers: [
            { text: "Prijateljski, korisni kad mi ne코to treba", score: 1 },
            { text: "Glavni su izvor oru쬵a i alata", score: 3 },
            { text: "Dobri za informacije i zalihe", score: 2 },
            { text: "Sumnji캜avo, izbegavam ih", score: 0 }
        ]
    },
    {
        question: "Ako je server u opasnosti od brisanja, 코ta radi코?",
        answers: [
            { text: "Prestanem da igram", score: 0 },
            { text: "Po캜injem ispo캜etka (to je deo zabave)", score: 2 },
            { text: "맚edim resurse za novi start", score: 1 },
            { text: "Uni코tavam tu캠e baze iz osvete", score: 3 }
        ]
    },
    {
        question: "맚a misli코 o igra캜ima-kultistima?",
        answers: [
            { text: "Lo코i su, treba ih izbegavati", score: 1 },
            { text: "Dobar su izvor resursa kad pobedi코", score: 2 },
            { text: "Zanimljivi su, ali rizi캜ni", score: 3 },
            { text: "Pridru쬿jem im se i te캜im", score: 0 }
        ]
    },
    {
        question: "맚a radi코 sa Diamond resursom?",
        answers: [
            { text: "Prodajem ga za hranu", score: 1 },
            { text: "Koristim za najnaprednije recepte", score: 3 },
            { text: "캛uvam ga za kraj igre", score: 2 },
            { text: "Ignori코em jer mislim da je nebitan", score: 0 }
        ]
    },
    {
        question: "Ako na캠e코 napu코tenu kolibu, 코ta uradi코?",
        answers: [
            { text: "Brzo ulazim, uzmem sve i idem", score: 1 },
            { text: "Pa쬷jivo tra쬴m zamke", score: 2 },
            { text: "Koristim je kao privremeni 코ator", score: 3 },
            { text: "Spaljujem je, ne 쬰lim iko drugi koristi", score: 0 }
        ]
    },
    {
        question: "Najbolji na캜in za dobijanje krzna?",
        answers: [
            { text: "Lovim male zveri blizu baze", score: 1 },
            { text: "Lovim medvede", score: 3 },
            { text: "Tra쬴m u sanducima i chestovima", score: 2 },
            { text: "Moli druge igra캜e da ti daju", score: 0 }
        ]
    },
    {
        question: "Kada je najbolje vreme za istra쬴vanje?",
        answers: [
            { text: "Ujutru (posle svitanja)", score: 2 },
            { text: "Tokom dana", score: 3 },
            { text: "Predve캜e", score: 1 },
            { text: "U pono캖", score: 0 }
        ]
    },
    {
        question: "맚a radi코 sa vi코kom mesa?",
        answers: [
            { text: "Pravim ra쬹ji캖e (skewers) za bolju efikasnost", score: 3 },
            { text: "캛uvam ga u sanduku (Chest)", score: 2 },
            { text: "Dijelim ga sa saigra캜ima", score: 1 },
            { text: "Bacim jer je zauzima mesto", score: 0 }
        ]
    },
    {
        question: "맚a uradi코 kada krene grmljavina?",
        answers: [
            { text: "Tr캜im nazad u bazu", score: 1 },
            { text: "Ignori코em i nastavim raditi", score: 3 },
            { text: "Brzo pravim zaklon (Shelter)", score: 2 },
            { text: "Lovim gromove (za sre캖u)", score: 0 }
        ]
    },
    {
        question: "캛ime popravlja코 oru쬵e?",
        answers: [
            { text: "Kamenom", score: 1 },
            { text: "콯eljezom (Iron)", score: 3 },
            { text: "Otpadnim metalom (Scrap)", score: 2 },
            { text: "Nikad ne popravljam, radim novo", score: 0 }
        ]
    },
    {
        question: "Koji neprijatelj se kre캖e najbr쬰?",
        answers: [
            { text: "말코mi코 (The Bat)", score: 3 },
            { text: "Jelen (The Deer)", score: 2 },
            { text: "Sova (The Owl)", score: 1 },
            { text: "Vuk", score: 0 }
        ]
    },
    {
        question: "Ako ti se vatra ugasi no캖u, 코ta prvo radi코?",
        answers: [
            { text: "Upalim upalja캜em odmah", score: 2 },
            { text: "Pali코 baklju da osvetli코", score: 1 },
            { text: "캛ekam pomo캖 prijatelja", score: 0 },
            { text: "Iskoristim momenat za prikriveno kretanje", score: 3 }
        ]
    },
    {
        question: "Koju klasu/opremu je najte쬰 nabaviti?",
        answers: [
            { text: "Basic Survival Gear (osnovna oprema)", score: 1 },
            { text: "Scout klasa", score: 2 },
            { text: "Lovacka klasa", score: 3 },
            { text: "Kultist klasa", score: 0 }
        ]
    },
    {
        question: "Kako najefikasnije sakuplja코 kaktuse?",
        answers: [
            { text: "Sekira", score: 1 },
            { text: "Kramp", score: 3 },
            { text: "Golim rukama", score: 0 },
            { text: "Ma캜em", score: 2 }
        ]
    },
    {
        question: "맚a radi코 kada vidi코 igra캜a sa niskim HP?",
        answers: [
            { text: "Dajem mu zavoje i hranu", score: 1 },
            { text: "맚itim ga i poku코avam izle캜iti", score: 2 },
            { text: "Iskoristim priliku da ga lootujem", score: 3 },
            { text: "Ignori코em ga", score: 0 }
        ]
    },
    {
        question: "Kako se najbolje sakrije코 od Sove?",
        answers: [
            { text: "U캠em u pe캖inu", score: 3 },
            { text: "Pri캜vrstim se uz drvo i mirno stojim", score: 1 },
            { text: "Sko캜im u vodu (jezero)", score: 2 },
            { text: "Tr캜im cik-cak be쬰캖i", score: 0 }
        ]
    },
    {
        question: "Omiljena hrana za du쬿 ekspediciju?",
        answers: [
            { text: "Pe캜eno meso", score: 2 },
            { text: "Bobice i gljive", score: 1 },
            { text: "Mesni ra쬹ji캖i (skewers)", score: 3 },
            { text: "Sirovo meso", score: 0 }
        ]
    },
    {
        question: "Koliko ti je va쬹a estetika baze u odnosu na funkcionalnost?",
        answers: [
            { text: "Funkcionalnost 100% (iznad izgleda)", score: 3 },
            { text: "I lepo i funkcionalno", score: 2 },
            { text: "Bitno je da baza pre쬴vi napad", score: 1 },
            { text: "Samo gradim da bih se hvalio", score: 0 }
        ]
    },
    {
        question: "Koji je najve캖i izazov igranja u timu?",
        answers: [
            { text: "Duga캜ki period 캜ekanja (dosada)", score: 1 },
            { text: "Odr쬬vanje vatre neprekidno", score: 2 },
            { text: "Borba protiv jakih neprijatelja skupa", score: 3 },
            { text: "Protiv mene nema izazova", score: 0 }
        ]
    },
    {
        question: "Koji materijal koristi코 za izradu zamki?",
        answers: [
            { text: "Drvo", score: 1 },
            { text: "Konopac", score: 2 },
            { text: "Gvo쮃년 (Iron)", score: 3 },
            { text: "Listovi", score: 0 }
        ]
    },
    {
        question: "Kako gleda코 na pe캖ine?",
        answers: [
            { text: "Izbegavam ih, previ코e su opasne", score: 1 },
            { text: "Opasne, ali pune resursa", score: 3 },
            { text: "Dobar su skloni코te (ako su sigurni)", score: 2 },
            { text: "Idem tamo samo sa timom", score: 0 }
        ]
    },
    {
        question: "Koja je mana igranja u timu?",
        answers: [
            { text: "Potro코nja resursa je ve캖a", score: 2 },
            { text: "Te쬰 je organizovati sve", score: 1 },
            { text: "Napreduje코 sporije ako svi dele", score: 0 },
            { text: "Uvek postoji rizik izdaje/trolla", score: 3 }
        ]
    },
    {
        question: "Koji simbol najvi코e asocira na kultiste?",
        answers: [
            { text: "Jelenova glava", score: 2 },
            { text: "Oka캜ena baklja", score: 1 },
            { text: "Tajanstveni znaci na drve캖u", score: 3 },
            { text: "Nemaju jedinstveni simbol", score: 0 }
        ]
    },
    {
        question: "Koju lokaciju najvi코e izbegava코?",
        answers: [
            { text: "Otvoreno polje danju", score: 0 },
            { text: "Gustu 코umu no캖u", score: 2 },
            { text: "Pe캖inu/lavirint", score: 3 },
            { text: "Po캜etnu zonu (spawn)", score: 1 }
        ]
    },
    {
        question: "Koju boju svetla koristi코 za signalizaciju?",
        answers: [
            { text: "Crvenu", score: 1 },
            { text: "Zelenu", score: 2 },
            { text: "Bela", score: 3 },
            { text: "Ne koristim svetlo", score: 0 }
        ]
    },
    {
        question: "Kako re코ava코 problem gladi?",
        answers: [
            { text: "Jedem bobice i jestivo bilje", score: 1 },
            { text: "Lovim medvede za meso", score: 3 },
            { text: "Radim farmu i uzgajam hranu", score: 2 },
            { text: "캛ekam da pro캠e vreme (dan)", score: 0 }
        ]
    },
    {
        question: "맚a radi코 ako ti se glavno oru쬵e polomi?",
        answers: [
            { text: "Prelazim na drugi arsenal (sekundarno)", score: 2 },
            { text: "Popravljam odmah na licu mesta", score: 3 },
            { text: "Be쬴m 코to br쬰 mogu", score: 1 },
            { text: "Borim se pesnicama dok mogu", score: 0 }
        ]
    },
    {
        question: "Kako se snalazi코 sa ograni캜enim inventarom?",
        answers: [
            { text: "Pravim vi코e sanduka za skladi코tenje", score: 2 },
            { text: "Birate samo najvrednije stvari", score: 3 },
            { text: "Vra캖am se 캜esto do baze", score: 1 },
            { text: "Bacam sve 코to nije bitno", score: 0 }
        ]
    },
    {
        question: "Koja je uloga baklje u borbi?",
        answers: [
            { text: "Samo osvetljava (nema borbenu ulogu)", score: 1 },
            { text: "Upla코iti male neprijatelje", score: 3 },
            { text: "Skre캖e pa쬹ju zverima", score: 2 },
            { text: "Nema nikakvog efekta", score: 0 }
        ]
    },
    {
        question: "맚a radi코 pre prelaska mosta?",
        answers: [
            { text: "Tr캜im 코to br쬰 mogu preko", score: 1 },
            { text: "Proverim okru쬰nje pre prelaska", score: 2 },
            { text: "Spremim se za borbu na sredini", score: 3 },
            { text: "Pravim put oko mosta (zaobilazim)", score: 0 }
        ]
    },
    {
        question: "맚a ti najvi코e poma쬰 protiv napada jelena?",
        answers: [
            { text: "Kvalitetan oklop", score: 3 },
            { text: "Velika udaljenost", score: 1 },
            { text: "Skloni코te (zatvoreni prostor)", score: 2 },
            { text: "Dobra zaliha hrane", score: 0 }
        ]
    },
    {
        question: "Kada koristi코 napitke (Potions)?",
        answers: [
            { text: "Samo protiv bossa", score: 3 },
            { text: "Kad mi zdravlje padne ispod 50%", score: 2 },
            { text: "Kad god mogu (svaki put)", score: 1 },
            { text: "Nikad, previ코e su retki", score: 0 }
        ]
    },
    {
        question: "Koji deo 코ume ti deluje najopasnije?",
        answers: [
            { text: "Sneg", score: 1 },
            { text: "Pe캖ine i podzemlje", score: 3 },
            { text: "Zona oko baze (캜este borbe)", score: 2 },
            { text: "Lava", score: 0 }
        ]
    },
    {
        question: "Koliko veruje코 drugim pre쬴velima?",
        answers: [
            { text: "Verujem svima dok ne izdaju", score: 1 },
            { text: "Samo poznatima iz stvarnog 쬴vota", score: 2 },
            { text: "Nikome, svi su potencijalni neprijatelji", score: 3 },
            { text: "Samo kultistima", score: 0 }
        ]
    },
    {
        question: "맚a radi코 nakon pre쬴vljavanja 99 no캖i?",
        answers: [
            { text: "Prona캠em izlaz i pobegnem", score: 3 },
            { text: "Gradim masivnu bazu (nastavljam igru)", score: 2 },
            { text: "Postajem najbolji trgovac", score: 1 },
            { text: "Uni코tim ceo server (grim scenario)", score: 0 }
        ]
    },
    {
        question: "Kako se priprema코 za oluju?",
        answers: [
            { text: "Pokupim metalne stvari unutra", score: 2 },
            { text: "Ostajem unutra u bazi", score: 1 },
            { text: "Izlazim napolje da privu캜em neprijatelje", score: 3 },
            { text: "Tr캜im nasumice po 코umi", score: 0 }
        ]
    },
    {
        question: "Koji emote ti je omiljen?",
        answers: [
            { text: "Emote 'Spavanje'", score: 1 },
            { text: "Emote 'Ma코em'", score: 2 },
            { text: "Emote 'Flex'", score: 3 },
            { text: "Ne koristim emote", score: 0 }
        ]
    },
    {
        question: "Najbr쬴 na캜in za sakupljanje krzna?",
        answers: [
            { text: "캛ekati da trgovac do캠e", score: 0 },
            { text: "Loviti male 쬴votinje blizu baze", score: 1 },
            { text: "Postavljati zamke u klju캜nim zonama", score: 2 },
            { text: "Loviti medvede i sove", score: 3 }
        ]
    }
];

// Inicijalne promenljive
let currentQuestionIndex = 0;
let totalScore = 0;
let shuffledQuestions = [];

// DOM elementi
const welcomeSection = document.getElementById('welcome-section');
const startButton = document.getElementById('start-button');
const quizSection = document.getElementById('quiz-section');
const resultSection = document.getElementById('result-section');
const questionNumberEl = document.getElementById('question-number');
const questionTextEl = document.getElementById('question-text');
const answersContainer = document.getElementById('answers-container');
const finalScoreEl = document.getElementById('final-score');
const errorMessageEl = document.getElementById('error-message');

// NOVI DOM elementi za e-mail
const emailInput = document.getElementById('email-input');
const submitEmailButton = document.getElementById('submit-email-button');
const emailErrorEl = document.getElementById('email-error');
const emailSuccessEl = document.getElementById('email-success');
const restartButtonAfterEmail = document.getElementById('restart-button-after-email');

// #region - GLAVNE FUNKCIJE KVIZA
function showQuestion() {
    if (currentQuestionIndex >= QUIZ_LENGTH) {
        showResult();
        return;
    }

    const currentQuestion = shuffledQuestions[currentQuestionIndex];
    questionNumberEl.textContent = `Pitanje ${currentQuestionIndex + 1}/${QUIZ_LENGTH}`;
    questionTextEl.textContent = currentQuestion.question;
    errorMessageEl.textContent = ''; 
    answersContainer.innerHTML = '';
    const shuffledAnswers = shuffleArray([...currentQuestion.answers]);
    shuffledAnswers.forEach(answer => {
        const button = document.createElement('button');
        button.textContent = answer.text;
        button.classList.add('answer-btn');
        button.dataset.score = answer.score;
        button.addEventListener('click', handleAnswer);
        answersContainer.appendChild(button);
    });
}
function handleAnswer(event) {
    const selectedButton = event.target;
    const score = parseInt(selectedButton.dataset.score);

    totalScore += score;
    currentQuestionIndex++;
    
    setTimeout(showQuestion, 150);
}
function showResult() {
    quizSection.classList.add('hidden');
    resultSection.classList.remove('hidden');

    finalScoreEl.textContent = `Ukupno ste osvojili: ${totalScore} poena.`;

    emailInput.value = ''; 
    emailErrorEl.textContent = '';
    emailSuccessEl.classList.add('hidden');
    restartButtonAfterEmail.classList.add('hidden'); 
    submitEmailButton.classList.remove('hidden');
    emailInput.classList.remove('hidden');
    emailInput.disabled = false;
    submitEmailButton.disabled = false;
    submitEmailButton.textContent = 'Po코alji Rezultate';
}
function isValidEmail(email) {
    const re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    return re.test(String(email).toLowerCase());
}
function submitEmail() {
    GOOGLE_APP_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbw3dbzwmAsjoy9g7rky-EN5InBvS1dotpyyfVxqDyW8TFI0YKwHcdsU97kXxIm27vRm/exec"

    const email = emailInput.value.trim();
    emailErrorEl.textContent = '';
    emailSuccessEl.classList.add('hidden');

    if (!email) {
        emailErrorEl.textContent = 'Molimo unesite e-mail adresu.';
        return;
    }
    if (!isValidEmail(email)) {
        emailErrorEl.textContent = 'Uneta e-mail adresa nije validna.';
        return;
    }

    const userClass = getFinalTitle(totalScore);
    
    const formData = new FormData();
    formData.append('email', email);
    formData.append('score', totalScore);
    formData.append('userClass', userClass);

    // Privremeno onemogu캖i dugme i polje
    submitEmailButton.disabled = true;
    emailInput.disabled = true;
    submitEmailButton.textContent = 'Slanje...';
    emailErrorEl.textContent = ''; 

    // Slanje podataka preko Fetch API-ja
    fetch(GOOGLE_APP_SCRIPT_URL, {
        method: 'POST',
        body: formData,
        mode: 'cors'
    })
    .then(response => response.json())
    .then(data => {
        
        // Prikaz rezultata i resetovanje forme
        emailInput.classList.add('hidden');
        submitEmailButton.classList.add('hidden');
        restartButtonAfterEmail.classList.remove('hidden');

        if (data.status === 'success') {
            // USPENO SA캛UVANO
            emailSuccessEl.innerHTML = `Va코 rezultat je uspe코no sa캜uvan! <br> Va코a klasa je: <strong>${data.userClass}</strong>.`;
            emailSuccessEl.classList.remove('hidden');
        } else if (data.status === 'duplicate') {
             // DUPLIKAT
             emailSuccessEl.innerHTML = `<strong>${data.message}</strong> <br> Va코a klasa je: <strong>${data.userClass}</strong>.`;
             emailSuccessEl.classList.remove('hidden');
        } else {
            // Generalna gre코ka 
            emailErrorEl.textContent = data.message || 'Gre코ka prilikom obrade rezultata. Poku코ajte ponovo.';
            
            // Otkrij klasu korisniku uprkos gre코ci
            emailSuccessEl.innerHTML = `NAPOMENA: Do코lo je do gre코ke u sistemu. <br> Va코a klasa je: <strong>${userClass}</strong>`;
            emailSuccessEl.classList.remove('hidden');
        }
    })
    .catch(error => {
        console.error('Do코lo je do gre코ke prilikom slanja:', error);
        emailErrorEl.textContent = 'Do코lo je do gre코ke u komunikaciji sa serverom.';
        submitEmailButton.disabled = false;
        emailInput.disabled = false;
        submitEmailButton.textContent = 'Po코alji Rezultate';
        
        // Otkrij klasu korisniku uprkos gre코ci u slanju
        emailInput.classList.add('hidden');
        submitEmailButton.classList.add('hidden');
        restartButtonAfterEmail.classList.remove('hidden');
        emailSuccessEl.innerHTML = `NAPOMENA: Rezultati NISU sa캜uvani zbog gre코ke. <br> Va코a klasa je: <strong>${userClass}</strong>`;
        emailSuccessEl.classList.remove('hidden');
    });
}
function getFinalTitle(score) {
    if (score >= 75) {
        return "ELITNI LOVAC"; 
    } else if (score >= 55) {
        return "BESPREKORNI PRE콯IVELI";
    } else if (score >= 35) {
        return "OPREZNI IZVI캟A캛";
    } else if (score >= 15) {
        return "PO캛ETNIK U UMI";
    } else {
        return "KULTISTA"; 
    }
}
function restartQuiz() {
    currentQuestionIndex = 0;
    totalScore = 0;
    resultSection.classList.add('hidden');
    welcomeSection.classList.remove('hidden');
    emailInput.classList.remove('hidden');
    submitEmailButton.classList.remove('hidden');
    emailSuccessEl.classList.add('hidden');
    restartButtonAfterEmail.classList.add('hidden');
    emailInput.value = '';
    emailErrorEl.textContent = '';
    emailInput.disabled = false;
    submitEmailButton.disabled = false;
    submitEmailButton.textContent = 'Po코alji Rezultate';

    shuffledQuestions = shuffleArray([...questions]).slice(0, QUIZ_LENGTH);
}
function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}
function startQuiz() {
    welcomeSection.classList.add('hidden');
    quizSection.classList.remove('hidden');
    if (shuffledQuestions.length !== QUIZ_LENGTH) {
        shuffledQuestions = shuffleArray([...questions]).slice(0, QUIZ_LENGTH);
    }
    
    showQuestion();
}
shuffledQuestions = shuffleArray([...questions]).slice(0, QUIZ_LENGTH);
startButton.addEventListener('click', startQuiz); 

// NOVI EVENT LISTENERS
submitEmailButton.addEventListener('click', submitEmail);
restartButtonAfterEmail.addEventListener('click', restartQuiz);
//#endregion
</script>

<style>
/* --- PROMENLJIVE --- */
:root {
    --color-bg: #121212; /* Ekstremno tamna pozadina, no캖 */
    --color-primary: #f0f0f0; /* Svetli tekst za 캜itljivost */
    --color-accent: #90ee90; /* Svetla, neon zelena (Glow/Misterija efekt) */
    --color-button-bg: #1e1e1e; /* Tamnija pozadina dugmeta */
    --color-danger: #ff4d4d; /* Za poruke o gre코kama */
    --font-primary: 'Poppins', sans-serif;
}
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: var(--font-primary);
}

/* --- BODY I KONTEJNER --- */
body {
    background-color: var(--color-bg);
    color: var(--color-primary);
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    padding: 20px;
    background-image: radial-gradient(#222222 1px, transparent 0);
    background-size: 40px 40px;
}
.container {
    background-color: #1a1a1a;
    padding: 40px;
    border-radius: 15px;
    box-shadow: 0 0 40px rgba(0, 0, 0, 0.5), 0 0 15px rgba(144, 238, 144, 0.2);
    max-width: 800px;
    width: 100%;
    text-align: center;
    border: 1px solid #333;
    /* Dodata margina za male ekrane da ne smeta fiksnom headeru */
    margin-top: 80px; 
}

/* --- TYPOGRAPHY --- */
h1 {
    font-size: 2.5em;
    margin-bottom: 20px;
    color: #fff;
    text-shadow: 0 0 15px rgba(144, 238, 144, 0.8), 0 0 5px rgba(144, 238, 144, 0.6);
}
h2 {
    font-size: 1.8em;
    margin-top: 10px;
    margin-bottom: 25px;
    color: var(--color-primary);
}
.intro-text, .result-description {
    font-size: 1.1em;
    margin: 20px auto 40px auto;
    max-width: 600px;
    color: #b0b0b0;
    line-height: 1.6;
}
.result-description{
    padding: 0;
    margin: 15px auto;
    color: #fff;
}
#question-number {
    font-size: 1.4em;
    color: var(--color-accent);
    margin-bottom: 10px;
    text-shadow: 0 0 5px rgba(144, 238, 144, 0.4);
}
#question-text {
    font-size: 1.5em;
    margin-bottom: 30px;
    line-height: 1.5;
    font-weight: 700;
}

/* --- DUGMAD --- */
.btn {
    background-color: var(--color-accent);
    color: var(--color-bg);
    border: none;
    padding: 12px 30px;
    font-size: 1.2em;
    font-weight: 700;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 0 10px rgba(144, 238, 144, 0.4);
    text-transform: uppercase;
    letter-spacing: 1px;
}
.btn:hover {
    background-color: #aaffaa;
    color: #000;
    transform: translateY(-3px) scale(1.02);
    box-shadow: 0 8px 20px rgba(144, 238, 144, 0.8);
}

/* Grid za odgovore */
.answers-grid {
    display: grid;
    grid-template-columns: 1fr 1fr; /* 2 kolone na desktopu */
    gap: 15px;
    margin-top: 20px;
}

/* Dugmad za odgovore (Pobolj코ana responzivnost) */
.answer-btn {
    background-color: var(--color-button-bg);
    color: var(--color-primary);
    border: 1px solid #3a3a3a;
    min-height: 90px; 
    display: flex; 
    align-items: center; 
    justify-content: center; 
    padding: 10px;
    font-size: 1.1em;
    border-radius: 8px;
    cursor: pointer;
    transition: background-color 0.3s, transform 0.1s, border-color 0.3s, color 0.3s;
    text-align: center; 
    line-height: 1.4;
    font-weight: 400;
}
.answer-btn:hover {
    background-color: #2a2a2a;
    border-color: var(--color-accent);
    color: var(--color-accent);
    transform: scale(1.03);
    box-shadow: 0 0 5px rgba(144, 238, 144, 0.3);
}

/* --- REZULTATI --- */
#final-score {
    font-size: 1.4em;
    margin: 20px 0 10px 0;
    color: #b0b0b0;
}
.error-msg {
    color: var(--color-danger);
    font-weight: 700;
    margin-top: 15px;
}

/* NOVI STILOVI ZA E-MAIL FORMU */
#email-submission {
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 15px;
    max-width: 400px;
}
#email-input {
    width: 100%;
    padding: 15px;
    font-size: 1.1em;
    border-radius: 8px;
    border: 2px solid #3a3a3a;
    background-color: #222;
    color: var(--color-primary);
    text-align: center;
    transition: border-color 0.3s, box-shadow 0.3s;
}
#email-input:focus {
    outline: none;
    border-color: var(--color-accent);
    box-shadow: 0 0 10px rgba(144, 238, 144, 0.5);
}
.email-btn {
    width: 100%;
    padding: 15px;
}
.success-msg {
    color: var(--color-success);
    font-weight: 700;
    margin: 15px;
    font-size: 1.1em;
    padding: 15px;
    border: 1px solid var(--color-success);
    border-radius: 5px;
    background-color: rgba(50, 205, 50, 0.1);
}

/* Skriveni elementi */
.hidden {
    display: none;
}

/* --- HEADER STILIZACIJA --- */
#header {
    position: fixed; 
    top: 0;
    left: 0;
    width: 100%;
    z-index: 1000;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px 150px;
    background-color: transparent !important;
}
.logo img {
    height: 60px; 
    width: auto;
    filter: invert(100%) brightness(150%);
    display: block;
    transition: transform 0.3s;
}
.logo img:hover {
    transform: scale(1.05);
}
.linktree {
    color: #f0f0f0;
    font-size: 26px;
    transition: 0.3s;
}
.linktree:hover {
    color: #8541b8;
}

/* --- MEDIA QUERIES (Responzivnost) --- */
@media(max-width: 1024px) {
    #header {
        padding: 20px 50px;
    }
}

@media(max-width: 768px) {
    #header {
        padding: 15px 20px;
        background-color: var(--color-bg);
    }
    .logo img {
        height: 45px;
    }
    .container {
        padding: 25px;
        margin-top: 70px; 
    }
    h1 {
        font-size: 2em;
    }
    h2 {
        font-size: 1.5em;
    }
    #question-text {
        font-size: 1.3em;
    }
    .answers-grid {
        grid-template-columns: 1fr;
    }
    .answer-btn {
        min-height: auto; 
        height: auto; 
        padding: 15px 10px; 
        font-size: 1.05em;
        white-space: normal; 
    }
    #email-submission {
        max-width: 100%;
    }
}

@media(max-width: 480px) {
    #header {
        padding: 10px 15px;
    }
    .logo img {
        height: 40px;
    }
    .container {
        padding: 20px;
        margin-top: 60px;
    }
    h1 {
        font-size: 1.7em;
    }
    .btn {
        padding: 10px 20px;
        font-size: 1em;
    }
    .answer-btn {
        font-size: 1em;
        padding: 12px 10px;
    }
}
</style>